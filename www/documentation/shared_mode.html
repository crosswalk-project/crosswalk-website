<!DOCTYPE html>
<html id="top" lang="en-us">
  <head>
    <meta charset="utf-8">
    <title>The Crosswalk Project</title>
    <link rel="shorcut icon" href="/assets/favicon.ico" type="image/x-icon" />
    <link rel="icon" href="/assets/favicon.ico" type="image/x-icon" />
    <script>
      WebFontConfig = {
        custom: {
          families: ['Clear Sans'],
          urls: ['/css/fonts.css']
        },
        google: {
          families: ['Source Code Pro:n4,n6']
        },
        timeout: 2000
      };
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script async defer src="//ajax.googleapis.com/ajax/libs/webfont/1.5.3/webfont.js"></script>
    <link rel="stylesheet" href="/css/main.css">

    <meta name="description" content="Enable the most advanced web innovations with the Crosswalk Project web runtime to develop powerful Android and Cordova apps." />
    <meta name="author" content="Crosswalk" />
    <meta name="handheldfriendly" content="true" />
    <meta name="mobileoptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="cleartype" content="on" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <!-- Facebook -->
    <meta property="og:side_name" content="Crosswalk" />
    <meta property="og:title" content="Shared Mode" />
    <meta property="og:url" content="http://crosswalk-project.org/documentation/shared_mode" />
    <meta property="og:description" content="Enable the most advanced web innovations with the Crosswalk Project web runtime to develop powerful Android and Cordova apps." />
    <meta property="og:image" content="/assets/crosswalk-og-banner.jpg" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:url" content="http://crosswalk-project.org/documentation/shared_mode" />
    <meta name="twitter:title" content="Shared Mode" />
    <meta name="twitter:description" content="Enable the most advanced web innovations with the Crosswalk Project web runtime to develop powerful Android and Cordova apps." />
    <meta name="twitter:site" content="@xwalk_project" />

    <!-- Relevant original Crosswalk Project JS -->
    <script src="/js/utils.js"></script>
    <script src="/js/xwalk.js"></script>
    <script src="/js/versions.js"></script>
    <script src="/js/demos.js"></script>
    <script src="/js/testimonials.js"></script>
    <script src="/js/tools.js"></script>
    <script src="/js/qualityindicators.js"></script>
  </head>
  <body>
    <!-- If curr page named 'index' and less than 2 dirs deep,
         do custom layouts. (home screen, blog, app-mgmt page)
         Else, provide doc header and nav. -->
    
    <div class="container">
      <div class="doc-header">
        

  

  <div class="doc-logo-div">
     <a href="/" class="doc-logo-link">
       <img src="/assets/identity/crosswalkproject-logo-horizontal-dark.png" class="doc-logo-img">
     </a>
  </div>
  <div class="doc-nav-div">
    <ul class="doc-nav-list">
      <li class="doc-nav-item">
        <a href="/documentation/getting_started.html" class="doc-nav-link">Documentation</a>
      </li>
      <li class="doc-nav-item">
        <a href="/blog" class="doc-nav-link">Blog</a>
      </li>
      <li class="doc-nav-item">
        <a href="/contribute" class="doc-nav-link">Contribute</a>
      </li>
      <li class="doc-nav-item">
        <a href="https://github.com/crosswalk-project/crosswalk-website/wiki" class="doc-nav-link">Wiki</a>
      </li>
      <li class="doc-nav-item hide-on-small">
        <a href="/documentation/about/faq.html" class="doc-nav-link">FAQ</a>
      </li>
      <li class="doc-nav-item hide-on-small">
        <a href="/documentation/getting_started.html" class="doc-nav-link" style="border:1px solid #ec543b;padding:8px;color:#ec543b;" >get started</a>
      </li>
    </ul>
  </div>
  

      </div>
      <br />
      <div class="doc-main">
        <div class="row">
          
          
<nav id="contents" class="article-toc nav-toggleContainer">
  <a href="#contents" id="contents-toggle" class="button button--small button--tertiary nav-toggle">Table of Contents</a>
  <a href="./#contents-toggle" class="button button--small button--tertiary nav-toggle--dummy">Table of Contents</a>
  <ul class="article-list nav-toggleHide">
    
       <li class="article-item ">
         <a class="article-link" href="/documentation/about.html">About</a>

         
       </li>
    
       <li class="article-item ">
         <a class="article-link" href="/documentation/getting_started.html">Getting Started</a>

         
       </li>
    
       <li class="article-item ">
         <a class="article-link" href="/documentation/android.html">Android</a>

         
       </li>
    
       <li class="article-item ">
         <a class="article-link" href="/documentation/ios.html">iOS</a>

         
       </li>
    
       <li class="article-item ">
         <a class="article-link" href="/documentation/windows.html">Windows</a>

         
       </li>
    
       <li class="article-item ">
         <a class="article-link" href="/documentation/linux.html">Linux</a>

         
       </li>
    
       <li class="article-item ">
         <a class="article-link" href="/documentation/cordova.html">Cordova</a>

         
       </li>
    
       <li class="article-item ">
         <a class="article-link" href="/documentation/tizen.html">Tizen</a>

         
       </li>
    
       <li class="article-item ">
         <a class="article-link" href="/documentation/manifest.html">Manifest</a>

         
       </li>
    
       <li class="article-item ">
         <a class="article-link" href="/documentation/apis.html">APIs</a>

         
       </li>
    
       <li class="article-item ">
         <a class="article-link" href="/documentation/downloads.html">Downloads</a>

         
       </li>
    
       <li class="article-item  nav-item--active">
         <a class="article-link" href="/documentation/shared_mode.html">Shared Mode</a>

         
       </li>
    
       <li class="article-item ">
         <a class="article-link" href="/documentation/tutorials.html">Tutorials</a>

         
       </li>
    
       <li class="article-item ">
         <a class="article-link" href="/documentation/samples.html">Samples</a>

         
       </li>
    
       <li class="article-item ">
         <a class="article-link" href="/documentation/community.html">Community</a>

         
       </li>
    
       <li class="article-item ">
         <a class="article-link" href="/documentation/qa.html">Quality Assurance</a>

         
       </li>
    
  </ul>

</nav>



<article class="article article--hasToC">
  <h1>Shared Mode vs. Embedded Mode</h1>
<p>By default, the Crosswalk runtime is embedded with your application and included in the APK. In contrast, &quot;shared mode&quot; builds the application without the runtime, but the runtime must be downloaded later, at runtime.  &quot;Shared mode&quot; allows multiple Crosswalk applications to share one Crosswalk runtime. If the runtime is not already installed in the device, it will be downloaded either from the Google Play Store, or from a download location specified by the developer. Because the Crosswalk library is not included in the application&#39;s APK package, it is significantly smaller (~20MB).</p>
<h2><a class="doc-anchor" id="Pros"></a>Pros</h2>
<ul>
<li>Produces a significant smaller APK file size for Crosswalk applications (about 20MB smaller).</li>
<li>APKs built in shared mode are architecture independent. Only one package needs to be submitted to the Play Store. The architecture-dependent runtime will be downloaded later.</li>
<li>Crosswalk is updated independently of the application. Taking advantage of the latest improvements doesn&#39;t require an update of the application.</li>
</ul>
<h2><a class="doc-anchor" id="Cons"></a>Cons</h2>
<ul>
<li>If the Crosswalk runtime library is not already installed on the user&#39;s device, it will download when the app is first run. The normal startup process of the application will be interrupted.</li>
<li>An updated Crosswalk runtime may introduce incompatibility with already-installed, shared-mode apps. Developers need to test their applications against the latest Crosswalk release. Note that we do strive to maintain backwards compatibility.</li>
</ul>
<h1><a class="doc-anchor" id="package"></a>Packaging in shared mode</h1>
<h2><a class="doc-anchor" id="Using-the-make_apk-packaging-tool"></a>make_apk packaging tool</h2>
<p>To package the application in shared mode, use the option:</p>
<p><code>./make_apk.py --mode=shared ...</code></p>
<p>Note: shared mode is not yet supported by crosswalk-app-tools</p>
<h2><a class="doc-anchor" id="Using-Cordova"></a>Cordova build</h2>
<p>To create a cordova project in shared mode, use the option:</p>
<p><code>./bin/create --xwalk-shared-library ...</code></p>
<p>Note: shared mode is not yet supported by cordova-plugin-crosswalk-webview</p>
<h2><a class="doc-anchor" id="Using-an-IDE"></a>Using an IDE</h2>
<p>For Eclipse ADT users, add library reference to the path of the xwalk_shared_library project.</p>
<p>For Android Studio users, import the xwalk_shared_library.aar as dependency.</p>
<h1><a class="doc-anchor" id="How-to-Configure-the-download-URL"></a>How to Configure the download URL</h1>
<p>For testing purposes, it is possible to configure the application to download the Crosswalk runtime from a specific URL rather than the Google Play Store. Note that in any case there can only be one copy of the runtime installed in the device, no matter where it was downloaded from. Also, the Crosswalk package can only be installed if the user has enabled installation from untrusted sources.</p>
<h2><a class="doc-anchor" id="From-Packaging-Tool"></a>From Packaging Tool</h2>
<p>Use the option below for make_apk.py:</p>
<p><code>./make_apk.py --mode=shared --xwalk-apk-url=http://host/XWalkRuntimeLib.apk ...</code></p>
<h2><a class="doc-anchor" id="From-The-Crosswalk-Manifest"></a>From The Crosswalk Manifest</h2>
<p>Define an element with the key “xwalk_apk_url”:</p>
<pre><code>{
    &quot;name&quot;: &quot;XWalkApp&quot;,
    &quot;start_url&quot;: &quot;index.html&quot;,
    &quot;xwalk_apk_url&quot;: &quot;http://10.0.2.2/XWalkRuntimeLib.apk&quot;,
    ...
}</code></pre>
<h2><a class="doc-anchor" id="From-The-Android-Manifest"></a>From The Android Manifest</h2>
<p>Define a meta-data element with the name &quot;xwalk_apk_url&quot; inside the application tag:</p>
<pre><code>&lt;application android:name=&quot;org.xwalk.core.XWalkApplication&quot;&gt;
    &lt;meta-data android:name=&quot;xwalk_apk_url&quot;
               android:value=&quot;http://host/XWalkRuntimeLib.apk&quot; /&gt;
    ...
&lt;/application&gt;</code></pre>
<h1><a class="doc-anchor" id="Using-shared-mode-with-the-embedding-API"></a>Using shared mode with the embedding API</h1>
<p>Developers that are embedding Crosswalk in their application using the Embedding API can take advantage of the shared mode following the instructions below.</p>
<h2><a class="doc-anchor" id="Permissions"></a>Permissions</h2>
<p>Shared mode requires the following permissions to be enabled:</p>
<pre><code>ACCESS_NETWORK_STATE
ACCESS_WIFI_STATE
INTERNET
WRITE_EXTERNAL_STORAGE</code></pre>
<h2><a class="doc-anchor" id="XWalkApplication"></a>XWalkApplication</h2>
<p>XWalkApplication is necessary to get the resources from Crosswalk runtime library. You may use XWalkApplication directly in the Android manifest, or make your own application class extend XWalkApplication class.</p>
<pre><code>&lt;application android:name=&quot;org.xwalk.core.XWalkApplication&quot;&gt;
    ...
&lt;/application&gt;</code></pre>
<h2><a class="doc-anchor" id="XWalkActivity"></a>XWalkActivity</h2>
<p>XWalkActivity helps to execute all procedures for initializing the Crosswalk environment, and displays dialogs for interacting with the end-user if necessary. The activities that hold the XWalkView object might want to extend XWalkActivity to obtain this capability. For those activities, it’s important to override the abstract method onXWalkReady() that notifies the Crosswalk environment is ready.</p>
<p>In shared mode, the Crosswalk runtime library is not loaded yet at the moment the activity is created. So the developer can’t use embedding API in onCreate() as usual. All routines using embedding API should be inside onXWalkReady() or after onXWalkReady() is invoked.</p>
<pre><code>public class MyXWalkActivity extends XWalkActivity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

      // Initialize the activity as usual
        setContentView(R.layout.activity_main);

        // DO NOT do more than creating an instance with embedding API
        mXWalkView = (XWalkView) findViewById(R.id.xwalkview);
    }

    @Override
    protected void onXWalkReady() {
        // Do anything with embedding API
        mXWalkView.load(&quot;index.html&quot;, null);
    }
}</code></pre>
<h2><a class="doc-anchor" id="XWalkInitializer"></a>XWalkInitializer</h2>
<p>XWalkInitializer is a helper to initialize the Crosswalk environment as XWalkActivity. But unlike XWalkActivity, XWalkInitializer neither provide UI interactions to help the end-user to download the appropriate Crosswalk library, nor prompt messages to notify the specific error during initializing. Due to this limitation, XWalkInitializer only works for embedded mode, or for shared mode if the appropriate Crosswalk library has already been installed on the device.</p>
<pre><code>public class MyXWalkActivity extends Activity
        implements XWalkInitializer.XWalkInitListener {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        // Invoke this method at first
        XWalkInitializer.initAsync(this, this);

      // Initialize the activity as usual
        setContentView(R.layout.activity_main);

        // DO NOT do more than creating an instance with embedding API
        mXWalkView = (XWalkView) findViewById(R.id.xwalkview);
    }

    @Override
    public void onXWalkInitCompleted() {
        // Do anything with embedding API
        mXWalkView.load(&quot;index.html&quot;, null);
    }
}</code></pre>
<h2><a class="doc-anchor" id="Version-Check-Mechanism"></a>Version Check Mechanism</h2>
<p>Along with the version name (e.g. 13.38.208.0), each release of Crosswalk has an independent version which is an incremental version code to show the revision of embedding API. This version is recorded in the API_VERSION file as below:</p>
<p>API: 4
API_SDK: 2</p>
<p>The API version is for both of the Crosswalk application and runtime library. The MIN_API version is only for the runtime library, and indicates the minimal version of Crosswalk applications that the runtime library supports.</p>
<p>When loaded, the Crosswalk application will check the version of the runtime library installed on the device. If the version of the application is between the current version and minimal backward-compatible version of the runtime library, the versions match and the application can start. Otherwise, a dialog will pop up to to prompt the user to get the latest version of the runtime library.</p>
<h1><a class="doc-anchor" id="Architecture-Independence"></a>Architecture Independence</h1>
<p>The Crosswalk application in embedded mode now checks whether the architecture of the embedded Crosswalk runtime library matches the device. If the architecture matches, the application uses the embedded runtime library. Otherwise, it switches to shared mode. This means that if you only publish an ARM version of your package, a user of your application using an x86 device will be directed to the Play Store to download an x86-compatible version of the Crosswalk Project runtime.</p>
<h1><a class="doc-anchor" id="Built-in Updater"></a>Built-in Updater</h1>
<p>There is a built-in updater to help the user to get the APK of Crosswalk runtime library. By default, the updater will jump to the page of Crosswalk runtime library on Google Play Store, subsequent process will be up to the user. If the developer specified the download URL, the updater will launch the download manager to fetch the APK.</p>
<p>The developer can also distribute and maintain the specific version of Crosswalk runtime library in their own way. The built-in updater won’t be activated as long as the version of the installed runtime library matches the Crosswalk application.</p>

  <footer class="article-next">
    


  </footer>
</article>

          
        </div>
      </div>
    </div>
    

    <hr class="footer-divider" style="margin-top:125px; margin-bottom:0px" />
    <div style="position:relative; top:-30px;">
       <a href="/"><img src="/assets/cw-logo-circle.png" width="60px" style="display:block; margin: 0 auto;" /></a>
    </div>
    <footer class="footer footer--documentation" >
      <div class="container" >
        <div class="row">
          <div  class="footer-div">
            <img src="/assets/Twitter_logo_blue.png" width="20px" /> Follow  <a href="http://twitter.com/xwalk_project">@xwalk_project on Twitter</a> for the latest developer activities and project updates.
          </div>
          <div class="footer-div">
             Latest blog post:</br>
              
              
                <b><a href="/blog">Introducing Crosswalk Project Extensions for Intel® RealSense™ Technology</a></b><br/>
                &nbsp;(<span ><time class="js-vagueTime" datetime="Tue, 23 Feb 2016 00:00:00 GMT">2016-02-23T00:00</time></span>)
              
              <br/>
           </div>
          <div class="footer-div">
              <strong><a href="/feed.xml"><img src="/assets/rss-icon-16.gif" style="vertical-align:middle" /> RSS Feed</a></strong>
          </div>
          <div class="footer-div">
             <a href="/documentation">Documentation</a> &nbsp;
             <a href="/blog">Blog</a> &nbsp;
             <a href="/documentation/downloads.html">Downloads</a> <br />
             <a href="https://crosswalk-project.org/jira/secure/Dashboard.jspa">Issues</a> &nbsp;
             <a href="https://github.com/crosswalk-project">GitHub source</a> &nbsp;
             <a href="/sitemap.html">Sitemap</a> <br/>
          </div>
        </div>
        <div class="row">
            <small>
              The Crosswalk Project was created by the Intel Open Source Technology Center. Copyright © 2013–2016 Intel Corporation. All rights reserved. <a href="https://github.com/crosswalk-project/crosswalk-website/wiki/Privacy-Policy">Privacy policy</a>. *Other names and brands may be claimed as the property of others.
            </small>
        </div>
      </div>
    </footer>

    
    
      <!-- Google Tag Manager -->
      <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-WC843Q"
      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
      <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-WC843Q');</script>
      <!-- End Google Tag Manager -->
    
    <script src="/js/smoothScroll.js"></script>
    <script src="/js/vagueTime.js"></script>
    <!-- <script async defer src="/js/trmix.js"></script> -->
  </body>
</html>
